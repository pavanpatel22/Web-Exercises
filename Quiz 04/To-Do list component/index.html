<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>âœ¨ Advanced <todo-list> Component</title>
</head>
<body style="background:#0a0f1b;font-family:'Poppins',sans-serif;color:white;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;">
  <todo-list></todo-list>

  <script>
  class TodoList extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: 'open' });
      this._items = [];

      const template = document.createElement('template');
      template.innerHTML = `
        <style>
          :host {
            display: block;
            width: 380px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(18px) saturate(180%);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            padding: 22px;
            font-family: 'Poppins', sans-serif;
            animation: fadeIn .8s ease forwards;
          }

          @keyframes fadeIn {
            from {opacity: 0; transform: translateY(20px);}
            to {opacity: 1; transform: translateY(0);}
          }

          h2 {
            font-weight: 600;
            font-size: 1.3rem;
            text-align: center;
            margin-bottom: 18px;
            background: linear-gradient(45deg, #00e0ff, #ff57b9);
            -webkit-background-clip: text;
            color: transparent;
          }

          .input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 18px;
          }

          input {
            flex: 1;
            padding: 10px 12px;
            border-radius: 10px;
            border: none;
            background: rgba(255,255,255,0.12);
            color: #fff;
            font-size: 0.95rem;
            outline: none;
            transition: box-shadow .2s ease, background .2s ease;
          }
          input:focus {
            background: rgba(255,255,255,0.18);
            box-shadow: 0 0 0 2px #00e0ff;
          }

          button {
            background: linear-gradient(90deg, #00e0ff, #ff57b9);
            color: #0a0f1b;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            padding: 10px 14px;
            transition: transform .2s ease, box-shadow .2s ease;
          }
          button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,87,185,0.4);
          }

          ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 260px;
            overflow-y: auto;
            scrollbar-width: thin;
          }
          ul::-webkit-scrollbar { width: 6px; }
          ul::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 6px; }

          li {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 14px;
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            font-size: 0.95rem;
            animation: slideUp .3s ease;
          }

          @keyframes slideUp {
            from {opacity: 0; transform: translateY(8px);}
            to {opacity: 1; transform: translateY(0);}
          }

          .text {
            flex: 1;
            color: #fff;
            word-break: break-word;
          }

          .time {
            font-size: 0.75rem;
            color: #aaa;
            margin-right: 12px;
          }

          .remove {
            background: none;
            border: none;
            color: #ff77a9;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform .2s ease;
          }
          .remove:hover { transform: scale(1.2); }

          .empty {
            text-align: center;
            color: #999;
            padding: 12px;
            font-size: 0.9rem;
            opacity: 0.8;
          }
        </style>

        <h2>âœ¨ My To-Do List</h2>
        <div class="input-row">
          <input type="text" id="todoInput" placeholder="Add a new task..." />
          <button id="addBtn">Add</button>
        </div>
        <ul id="list"></ul>
        <div class="empty" id="empty">No tasks yet â€” start adding! ðŸš€</div>
      `;

      this.shadowRoot.append(template.content.cloneNode(true));

      this._input = this.shadowRoot.querySelector("#todoInput");
      this._addBtn = this.shadowRoot.querySelector("#addBtn");
      this._list = this.shadowRoot.querySelector("#list");
      this._empty = this.shadowRoot.querySelector("#empty");

      this._addItem = this._addItem.bind(this);
      this._handleKey = this._handleKey.bind(this);
      this._handleRemove = this._handleRemove.bind(this);
    }

    connectedCallback() {
      this._addBtn.addEventListener("click", this._addItem);
      this._input.addEventListener("keydown", this._handleKey);
      this._list.addEventListener("click", this._handleRemove);
      this._render();
    }

    disconnectedCallback() {
      this._addBtn.removeEventListener("click", this._addItem);
      this._input.removeEventListener("keydown", this._handleKey);
      this._list.removeEventListener("click", this._handleRemove);
    }

    get items() {
      return [...this._items];
    }

    set items(val) {
      if (Array.isArray(val)) {
        this._items = val;
        this._render();
        this._emitChange();
      }
    }

    _handleKey(e) {
      if (e.key === "Enter") this._addItem();
    }

    _addItem() {
      const text = this._input.value.trim();
      if (!text) return;
      this._items.push({ id: Date.now(), text, time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) });
      this._input.value = "";
      this._render();
      this._emitChange();
    }

    _handleRemove(e) {
      if (e.target.classList.contains("remove")) {
        const id = Number(e.target.dataset.id);
        this._items = this._items.filter(i => i.id !== id);
        this._render();
        this._emitChange();
      }
    }

    _render() {
      this._list.innerHTML = "";
      if (this._items.length === 0) {
        this._empty.style.display = "block";
        return;
      }
      this._empty.style.display = "none";

      for (const item of this._items) {
        const li = document.createElement("li");
        li.innerHTML = `
          <span class="text">${this._escape(item.text)}</span>
          <span class="time">${item.time}</span>
          <button class="remove" data-id="${item.id}" title="Remove">âœ–</button>
        `;
        this._list.appendChild(li);
      }
    }

    _emitChange() {
      this.dispatchEvent(new CustomEvent("listChanged", {
        detail: { items: this.items },
        bubbles: true,
        composed: true
      }));
    }

    _escape(str) {
      return str.replace(/[&<>"']/g, m => (
        { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[m]
      ));
    }
  }

  customElements.define("todo-list", TodoList);
  </script>
</body>
</html>
